// Calendário Maternal 2025
(function () {
  const calendarDataMaternal = {
    months: [
      {
        name: "Janeiro",
        days: [
          {
            date: 1,
            events: [{ type: "feriado", text: "Ano Novo" }],
          },
          {
            date: 2,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 3,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 4,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 5,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 6,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 7,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 8,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 9,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 10,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 11,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 12,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 13,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 14,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 15,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 16,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 17,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 18,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 19,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 20,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 21,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 22,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 23,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 24,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 25,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 26,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 27,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 28,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 29,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 30,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
          {
            date: 31,
            events: [{ type: "ferias", text: "Férias Escolares" }],
          },
        ],
      },
      {
        name: "Fevereiro",
        days: [
          { date: 1, events: [] },
          { date: 2, events: [] },
          {
            date: 3,
            events: [{ type: "pedagogica", text: "Semana Pedagógica" }],
          },
          {
            date: 4,
            events: [{ type: "pedagogica", text: "Semana Pedagógica" }],
          },
          {
            date: 5,
            events: [{ type: "pedagogica", text: "Semana Pedagógica" }],
          },
          {
            date: 6,
            events: [{ type: "pedagogica", text: "Semana Pedagógica" }],
          },
          {
            date: 7,
            events: [{ type: "pedagogica", text: "Semana Pedagógica" }],
          },
          { date: 8, events: [{ type: "reuniao", text: "Reunião de Pais" }] },
          { date: 9, events: [] },
          { date: 10, events: [{ type: "inicio", text: "Início das Aulas" }] },
          { date: 11, events: [] },
          { date: 12, events: [] },
          { date: 13, events: [] },
          { date: 14, events: [] },
          { date: 15, events: [] },
          { date: 16, events: [] },
          { date: 17, events: [] },
          { date: 18, events: [] },
          { date: 19, events: [] },
          { date: 20, events: [] },
          { date: 21, events: [] },
          { date: 22, events: [] },
          { date: 23, events: [] },
          { date: 24, events: [] },
          { date: 25, events: [] },
          { date: 26, events: [] },
          { date: 27, events: [] },
          { date: 28, events: [] },
        ],
      },
      {
        name: "Março",
        days: [
          { date: 1, events: [] },
          { date: 2, events: [] },
          { date: 3, events: [{ type: "feriado", text: "Feriado/Carnaval" }] },
          { date: 4, events: [{ type: "feriado", text: "Feriado/Carnaval" }] },
          { date: 5, events: [] },
          { date: 6, events: [] },
          { date: 7, events: [] },
          { date: 8, events: [] },
          { date: 9, events: [] },
          { date: 10, events: [] },
          { date: 11, events: [] },
          { date: 12, events: [] },
          { date: 13, events: [] },
          { date: 14, events: [] },
          { date: 15, events: [] },
          { date: 16, events: [] },
          { date: 17, events: [] },
          { date: 18, events: [] },
          { date: 19, events: [] },
          { date: 20, events: [] },
          { date: 21, events: [] },
          { date: 22, events: [] },
          { date: 23, events: [] },
          { date: 24, events: [] },
          { date: 25, events: [] },
          {
            date: 26,
            events: [{ type: "feriado", text: "Feriado/Emancipação Barueri" }],
          },
          { date: 27, events: [] },
          { date: 28, events: [] },
          { date: 29, events: [] },
          { date: 30, events: [] },
          { date: 31, events: [] },
        ],
      },
      {
        name: "Abril",
        days: [
          { date: 1, events: [] },
          { date: 2, events: [] },
          { date: 3, events: [] },
          { date: 4, events: [] },
          { date: 5, events: [] },
          { date: 6, events: [] },
          { date: 7, events: [] },
          { date: 8, events: [] },
          { date: 9, events: [] },
          { date: 10, events: [] },
          { date: 11, events: [] },
          { date: 12, events: [] },
          { date: 13, events: [] },
          { date: 14, events: [] },
          { date: 15, events: [] },
          { date: 16, events: [] },
          { date: 17, events: [{ type: "feriado", text: "Endoenças" }] },
          {
            date: 18,
            events: [{ type: "feriado", text: "Sexta-feira Santa" }],
          },
          { date: 19, events: [] },
          { date: 20, events: [{ type: "feriado", text: "Páscoa" }] },
          { date: 21, events: [{ type: "feriado", text: "Tiradentes" }] },
          { date: 22, events: [] },
          { date: 23, events: [] },
          { date: 24, events: [] },
          { date: 25, events: [] },
          { date: 26, events: [] },
          { date: 27, events: [] },
          { date: 28, events: [] },
          { date: 29, events: [] },
          { date: 30, events: [] },
        ],
      },
      {
        name: "Maio",
        days: [
          { date: 1, events: [{ type: "feriado", text: "Dia do Trabalho" }] },
          {
            date: 2,
            events: [
              { type: "Dia sem Expediente", text: "Dia sem Expediente" },
            ],
          },
          { date: 3, events: [] },
          { date: 4, events: [] },
          { date: 5, events: [] },
          { date: 6, events: [] },
          { date: 7, events: [] },
          { date: 8, events: [{ type: "evento", text: "Conselho de Classe" }] },
          { date: 9, events: [{ type: "evento", text: "Conselho de Classe" }] },
          { date: 10, events: [] },
          { date: 11, events: [] },
          { date: 12, events: [] },
          { date: 13, events: [] },
          { date: 14, events: [] },
          { date: 15, events: [] },
          { date: 16, events: [] },
          { date: 17, events: [] },
          { date: 18, events: [] },
          { date: 19, events: [] },
          { date: 20, events: [] },
          { date: 21, events: [] },
          { date: 22, events: [] },
          { date: 23, events: [] },
          { date: 24, events: [] },
          { date: 25, events: [] },
          { date: 26, events: [] },
          { date: 27, events: [] },
          { date: 28, events: [] },
          { date: 29, events: [] },
          { date: 30, events: [] },
          { date: 31, events: [] },
        ],
      },
      {
        name: "Junho",
        days: [
          { date: 1, events: [] },
          { date: 2, events: [] },
          { date: 3, events: [] },
          { date: 4, events: [] },
          { date: 5, events: [] },
          { date: 6, events: [] },
          { date: 7, events: [] },
          { date: 8, events: [] },
          { date: 9, events: [] },
          { date: 10, events: [] },
          { date: 11, events: [] },
          { date: 12, events: [] },
          { date: 13, events: [] },
          { date: 14, events: [{ type: "evento", text: "Festa Junina" }] },
          { date: 15, events: [] },
          { date: 16, events: [] },
          { date: 17, events: [] },
          { date: 18, events: [] },
          { date: 19, events: [{ type: "feriado", text: "Corpus Christi" }] },
          {
            date: 20,
            events: [
              { type: "Dia sem Expediente", text: "Dia sem Expediente" },
            ],
          },
          { date: 21, events: [] },
          { date: 22, events: [] },
          {
            date: 23,
            events: [
              { type: "Dia sem Expediente", text: "Dia sem Expediente" },
            ],
          },
          {
            date: 24,
            events: [{ type: "feriado", text: "Padroeiro São João Batista" }],
          },
          { date: 25, events: [] },
          {
            date: 26,
            events: [{ type: "evento", text: "Conselho de Classe" }],
          },
          {
            date: 27,
            events: [{ type: "evento", text: "Conselho de Classe" }],
          },
          { date: 29, events: [] },
          { date: 30, events: [] },
        ],
      },
      {
        name: "Julho",
        days: [
          { date: 1, events: [] },
          { date: 2, events: [] },
          { date: 3, events: [] },
          { date: 4, events: [{ type: "reuniao", text: "Reunião de Pais" }] },
          { date: 5, events: [] },
          { date: 6, events: [] },
          { date: 7, events: [{ type: "ferias", text: "Recesso Escolar" }] },
          { date: 8, events: [{ type: "ferias", text: "Recesso Escolar" }] },
          { date: 9, events: [{ type: "ferias", text: "Recesso Escolar" }] },
          { date: 10, events: [{ type: "ferias", text: "Recesso Escolar" }] },
          { date: 11, events: [{ type: "ferias", text: "Recesso Escolar" }] },
          { date: 12, events: [{ type: "ferias", text: "Recesso Escolar" }] },
          { date: 13, events: [{ type: "ferias", text: "Recesso Escolar" }] },
          { date: 14, events: [{ type: "ferias", text: "Recesso Escolar" }] },
          { date: 15, events: [{ type: "ferias", text: "Recesso Escolar" }] },
          { date: 16, events: [{ type: "ferias", text: "Recesso Escolar" }] },
          { date: 17, events: [{ type: "ferias", text: "Recesso Escolar" }] },
          { date: 18, events: [{ type: "ferias", text: "Recesso Escolar" }] },
          { date: 19, events: [{ type: "ferias", text: "Recesso Escolar" }] },
          { date: 20, events: [{ type: "ferias", text: "Recesso Escolar" }] },
          { date: 21, events: [] },
          { date: 22, events: [] },
          { date: 23, events: [] },
          { date: 24, events: [] },
          { date: 25, events: [] },
          { date: 26, events: [] },
          { date: 27, events: [] },
          { date: 28, events: [] },
          { date: 29, events: [] },
          { date: 30, events: [] },
          { date: 31, events: [] },
        ],
      },
      {
        name: "Agosto",
        days: [
          { date: 1, events: [] },
          { date: 2, events: [] },
          { date: 3, events: [] },
          { date: 4, events: [] },
          { date: 5, events: [] },
          { date: 6, events: [] },
          { date: 7, events: [] },
          { date: 8, events: [] },
          { date: 9, events: [] },
          { date: 10, events: [] },
          { date: 11, events: [] },
          { date: 12, events: [] },
          { date: 13, events: [] },
          { date: 14, events: [] },
          { date: 15, events: [] },
          { date: 16, events: [] },
          { date: 17, events: [] },
          { date: 18, events: [] },
          { date: 19, events: [] },
          { date: 20, events: [] },
          { date: 21, events: [] },
          { date: 22, events: [] },
          { date: 23, events: [] },
          { date: 24, events: [] },
          { date: 25, events: [] },
          { date: 26, events: [] },
          { date: 27, events: [] },
          { date: 28, events: [] },
          { date: 29, events: [] },
          { date: 30, events: [] },
          { date: 31, events: [] },
        ],
      },
      {
        name: "Setembro",
        days: [
          { date: 1, events: [] },
          { date: 2, events: [] },
          { date: 3, events: [] },
          { date: 4, events: [] },
          { date: 5, events: [] },
          { date: 6, events: [] },
          { date: 7, events: [{ type: "evento", text: "Civico Militar" }] },
          { date: 8, events: [] },
          { date: 9, events: [] },
          { date: 10, events: [] },
          { date: 11, events: [] },
          { date: 12, events: [] },
          { date: 13, events: [] },
          { date: 14, events: [] },
          { date: 15, events: [] },
          { date: 16, events: [] },
          { date: 17, events: [] },
          { date: 18, events: [] },
          { date: 19, events: [] },
          { date: 20, events: [] },
          { date: 21, events: [] },
          { date: 22, events: [] },
          { date: 23, events: [] },
          { date: 24, events: [] },
          {
            date: 25,
            events: [{ type: "evento", text: "Conselho de Classe" }],
          },
          {
            date: 26,
            events: [{ type: "evento", text: "Conselho de Classe" }],
          },
          { date: 27, events: [] },
          { date: 28, events: [] },
          { date: 29, events: [] },
          { date: 30, events: [] },
        ],
      },
      {
        name: "Outubro",
        days: [
          { date: 1, events: [] },
          { date: 2, events: [] },
          { date: 3, events: [] },
          { date: 4, events: [{ type: "reuniao", text: "Reunião de Pais" }] },
          { date: 5, events: [] },
          { date: 6, events: [] },
          { date: 7, events: [] },
          { date: 8, events: [] },
          { date: 9, events: [] },
          { date: 10, events: [] },
          { date: 12, events: [] },
          { date: 11, events: [] },
          { date: 13, events: [] },
          { date: 14, events: [] },
          {
            date: 15,
            events: [{ type: "Dia sem Expediente", text: "Dia do Professor" }],
          },
          { date: 16, events: [] },
          { date: 17, events: [] },
          { date: 18, events: [] },
          { date: 19, events: [] },
          { date: 20, events: [] },
          { date: 21, events: [] },
          { date: 22, events: [] },
          { date: 23, events: [] },
          { date: 24, events: [] },
          { date: 25, events: [] },
          { date: 26, events: [] },
          {
            date: 27,
            events: [
              { type: "Dia sem Expediente", text: "Dia sem Expediente" },
            ],
          },
          {
            date: 28,
            events: [{ type: "feriado", text: "Funcionário Publico" }],
          },
          { date: 29, events: [] },
          { date: 30, events: [] },
          { date: 31, events: [] },
        ],
      },
      {
        name: "Novembro",
        days: [
          { date: 1, events: [] },
          { date: 2, events: [] },
          { date: 3, events: [] },
          { date: 4, events: [] },
          { date: 5, events: [] },
          { date: 6, events: [{ type: "reuniao", text: "Reunião de Pais" }] },
          { date: 7, events: [] },
          { date: 8, events: [] },
          { date: 9, events: [] },
          { date: 10, events: [] },
          { date: 11, events: [] },
          { date: 12, events: [] },
          { date: 13, events: [] },
          { date: 14, events: [] },
          {
            date: 15,
            events: [{ type: "feriado", text: "Proclamação da República" }],
          },
          { date: 16, events: [] },
          { date: 17, events: [] },
          { date: 18, events: [] },
          { date: 19, events: [] },
          {
            date: 20,
            events: [{ type: "feriado", text: "Consciencia Negra" }],
          },
          {
            date: 21,
            events: [{ type: "feriado", text: "Nossa Senhora da Escada" }],
          },
          { date: 22, events: [] },
          { date: 23, events: [] },
          { date: 24, events: [] },
          { date: 25, events: [] },
          { date: 26, events: [] },
          { date: 27, events: [] },
          { date: 28, events: [] },
          { date: 29, events: [] },
          { date: 30, events: [] },
        ],
      },
      {
        name: "Dezembro",
        days: [
          { date: 1, events: [] },
          { date: 2, events: [] },
          { date: 3, events: [] },
          { date: 4, events: [{ type: "evento", text: "Conselho de Classe" }] },
          { date: 5, events: [{ type: "evento", text: "Conselho de Classe" }] },
          { date: 6, events: [] },
          { date: 7, events: [] },
          { date: 8, events: [] },
          { date: 9, events: [] },
          { date: 10, events: [] },
          { date: 11, events: [] },
          { date: 12, events: [] },
          { date: 13, events: [] },
          { date: 14, events: [] },
          { date: 15, events: [] },
          { date: 16, events: [] },
          { date: 17, events: [] },
          { date: 18, events: [] },
          { date: 19, events: [] },
          { date: 20, events: [] },
          { date: 21, events: [] },
          { date: 22, events: [] },
          { date: 23, events: [] },
          {
            date: 24,
            events: [
              { type: "Dia sem Expediente", text: "Dia sem Expediente" },
            ],
          },
          { date: 25, events: [] },
          {
            date: 26,
            events: [
              { type: "Dia sem Expediente", text: "Dia sem Expediente" },
            ],
          },
          { date: 27, events: [] },
          { date: 28, events: [] },
          { date: 29, events: [] },
          { date: 30, events: [] },
          {
            date: 31,
            events: [
              { type: "Dia sem Expediente", text: "Dia sem Expediente" },
            ],
          },
        ],
      },
    ],
  };

  function initializeCalendar() {
    const container = document.getElementById("calendarContainer");
    if (!container) return;
    container.innerHTML = "";
    calendarDataMaternal.months.forEach((month, idx) => {
      const monthCalendar = createMonthCalendar(month, idx);
      container.appendChild(monthCalendar);
    });
  }

  function showBimestreTotalDias(bimestre) {
    const span = document.getElementById("bimestreTotalDias");
    if (!span) return;
    if (!bimestre) {
      // Calcular total de dias letivos do ano
      let totalLetivos = 0;
      calendarDataMaternal.months.forEach((month) => {
        month.days.forEach((day) => {
          // Considera letivo se NÃO for feriado nem férias
          const isLetivo = !day.events.some(
            (ev) => ev.type === "feriado" || ev.type === "ferias"
          );
          if (isLetivo) totalLetivos++;
        });
      });
      span.textContent = `${totalLetivos} dias letivos`;
      span.classList.remove("hidden");
      return;
    }
    span.textContent = `${bimestreRanges[bimestre].dias} dias`;
    span.classList.remove("hidden");
  }

  // Inicialização automática ao carregar o script
  document.addEventListener("DOMContentLoaded", initializeCalendar);

  document.querySelectorAll(".bimestre-btn").forEach((btn) => {
    btn.addEventListener("click", function () {
      document
        .querySelectorAll(".bimestre-btn")
        .forEach((b) => b.classList.remove("bg-blue-400", "text-white"));
      this.classList.add("bg-blue-400", "text-white");
      highlightBimestre(this.dataset.bimestre);
      // Atualiza o número de dias do bimestre no header
      showBimestreTotalDias(this.dataset.bimestre);
    });
  });
  // Ao clicar fora dos botões, esconder o campo de dias e mostrar total de dias letivos
  const diasSpan = document.getElementById("bimestreTotalDias");
  document.addEventListener("click", function (e) {
    if (!e.target.classList.contains("bimestre-btn") && diasSpan) {
      document.querySelectorAll(".bimestre-btn").forEach(b => b.classList.remove("bg-blue-400", "text-white"));
      highlightBimestre(null);
      showBimestreTotalDias(null);
    }
  });

  // Função para criar o mês do calendário (copiada do EMEF)
  function createMonthCalendar(monthData, monthIndex) {
    const monthDiv = document.createElement("div");
    monthDiv.className = "calendar-month bg-white p-3 rounded-lg shadow-md mb-4";

    const monthHeader = document.createElement("h3");
    monthHeader.textContent = monthData.name;
    monthHeader.className = "text-lg font-bold mb-3 text-center";
    monthDiv.appendChild(monthHeader);

    const daysGrid = document.createElement("div");
    daysGrid.className = "grid grid-cols-7 gap-0.5 text-center text-xs";

    // Add weekday headers
    const weekdays = ["Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "Sáb"];
    weekdays.forEach((day) => {
      const dayHeader = document.createElement("div");
      dayHeader.textContent = day;
      dayHeader.className = "font-bold p-1 bg-gray-200 text-xs";
      daysGrid.appendChild(dayHeader);
    });

    // Descobrir o primeiro dia da semana do mês
    const firstDate = new Date(2025, monthIndex, 1);
    const firstWeekDay = firstDate.getDay(); // 0 = domingo, 1 = segunda, ...

    // Adicionar células vazias antes do dia 1
    for (let i = 0; i < firstWeekDay; i++) {
      const emptyDiv = document.createElement("div");
      emptyDiv.className = "p-1";
      daysGrid.appendChild(emptyDiv);
    }

    // Add days
    monthData.days.forEach((day) => {
      const dayDiv = document.createElement("div");
      dayDiv.textContent = day.date;
      dayDiv.className = "p-1 border min-h-[35px] relative text-xs";

      const date = new Date(2025, monthIndex, day.date);
      const weekDay = date.getDay();

      // Aplicar cores baseadas nos eventos
      if (day.events.length > 0) {
        const event = day.events[0];
        switch (event.type) {
          case "feriado":
            dayDiv.style.backgroundColor = "#ff0000";
            dayDiv.style.color = "#fff";
            break;
          case "ferias":
            dayDiv.style.backgroundColor = "#ff7878";
            break;
          case "pedagogica":
            dayDiv.style.backgroundColor = "#FFD700";
            break;
          case "reuniao":
            dayDiv.style.backgroundColor = "#7955FA";
            dayDiv.style.color = "#fff";
            break;
          case "inicio":
            dayDiv.style.backgroundColor = "#ffffff";
            dayDiv.style.border = "2px solid #000";
            break;
          case "evento":
            dayDiv.style.backgroundColor = "#edf574";
            break;
          case "Dia sem Expediente":
            dayDiv.style.backgroundColor = "#ff00ff";
            dayDiv.title = "Dia sem expediente";
            break;
          default:
            dayDiv.style.backgroundColor = "#87CEEB";
        }
        dayDiv.title = event.text;
      } else {
        // Sábados e domingos
        if (weekDay === 0 || weekDay === 6) {
          dayDiv.style.backgroundColor = "#ff0000";
          dayDiv.style.color = "#fff";
        } else {
          dayDiv.style.backgroundColor = "#87CEEB";
        }
      }
      daysGrid.appendChild(dayDiv);
    });

    monthDiv.appendChild(daysGrid);
    return monthDiv;
  }
})();

document.addEventListener("DOMContentLoaded", initializeCalendar);
